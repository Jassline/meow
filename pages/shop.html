<!DOCTYPE html>
<html lang="zh-Hant">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<head>
    <meta charset="UTF-8">
    <title>ç²¾é¸å•†å“ | MEOW SELECT</title>
    <link rel="stylesheet" href="../css/style.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <div class="overlay"></div>
    <div class="cart-sidebar"> </div>
    <nav>
        <a href="index.html" class="logo">MEOW SELECT</a>
        <div class="nav-links">
            <a href="../index.html" >é¦–é </a>
            <a href="about.html">å“ç‰Œæ•…äº‹</a> 
            <a href="shop.html" style="color:#ff9f43; font-weight:bold;">æ‰€æœ‰å•†å“</a>
            <a href="member.html">æœƒå“¡ä¸­å¿ƒ</a>
            <button id="cart-btn">ğŸ›’ è³¼ç‰©è»Š</button>
        </div>
    </nav>
    <!-- è³¼ç‰©è»Š HTML -->
    <div class="overlay"></div>
    <aside class="cart-sidebar">
        <div class="cart-header">
            <h3>å¦³çš„è³¼ç‰©è¢‹</h3>
            <button id="close-btn" type="button" class="icon-btn">&times;</button>
        </div>
        <div id="cart-items-list" class="cart-items"></div>
        <div class="cart-footer">
            <div class="cart-total-row">
                <span>ç¸½è¨ˆ</span>
                <span id="cart-total-display">$0</span>
            </div>
            <button class="checkout-btn" type="button" onclick="location.href='checkout.html'">å‰å¾€çµå¸³</button>
        </div>
    </aside>

    <div class="container shop-layout">
        <!-- å·¦å´ï¼šå¹´é½¡ç¯©é¸ -->
        <aside class="filter-sidebar">
            <h4>ğŸ¾ ä¾è²“å’ªå¹´é½¡é¸æ“‡</h4>

            <label>
                <input type="radio" name="age" value="" checked>
                å…¨éƒ¨
            </label>

            <label>
                <input type="radio" name="age" value="kitten">
                å¹¼è²“
            </label>

            <label>
                <input type="radio" name="age" value="adult">
                æˆè²“
            </label>

            <label>
                <input type="radio" name="age" value="senior">
                ç†Ÿé½¡è²“
            </label>
        </aside>

        <!-- å³å´ï¼šå•†å“ -->
        <div class="product-grid" id="shop-product-grid"></div>

    </div>


    <script src="../js/product.js"></script>
    <script src="../js/cart.js"></script>
    <script>
let currentAgeFilter = null;

function renderShop() {
  const grid = document.getElementById('shop-product-grid');
  if (!grid) return;

  grid.innerHTML = '';
  const data = window.products;
  if (!data) {
    console.error("âŒ products ä¸å­˜åœ¨");
    return;
  }

  Object.entries(data)
    .filter(([id, p]) => {
      if (!currentAgeFilter) return true;

      // é˜²å‘†ï¼šp.age å¯èƒ½æ˜¯é™£åˆ—æˆ–å­—ä¸²
      if (Array.isArray(p.age)) return p.age.includes(currentAgeFilter);
      if (typeof p.age === "string") return p.age === currentAgeFilter;
      return false;
    })
    .forEach(([id, p]) => {
      let priceText = "";
      if (p.variants && p.variants.length > 0) {
        const minPrice = Math.min(...p.variants.map(v => v.price));
        priceText = `$${minPrice} èµ·`;
      } else if (p.price) {
        priceText = `$${p.price}`;
      } else if (p.defaultPrice) {
        priceText = `$${p.defaultPrice}`;
      }

      grid.innerHTML += `
        <div class="product-card">
          <img src="${p.img}" alt="${p.name}">
          <h3>${p.name}</h3>
          <p class="price">${priceText}</p>
          <a href="product-detail.html?id=${id}">æŸ¥çœ‹è©³æƒ…</a>
        </div>
      `;
    });
}

document.addEventListener("DOMContentLoaded", () => {
  // âœ… 1) å…ˆè®€é¦–é å‚³ä¾†çš„åƒæ•¸
  const params = new URLSearchParams(location.search);
  const age = params.get("age"); // kitten / adult / senior

  if (["kitten", "adult", "senior"].includes(age)) {
    currentAgeFilter = age;

    // âœ… 2) è‡ªå‹•å‹¾é¸å°æ‡‰ radio
    const targetRadio = document.querySelector(`input[name="age"][value="${age}"]`);
    if (targetRadio) targetRadio.checked = true;
  } else {
    currentAgeFilter = null;
    const allRadio = document.querySelector(`input[name="age"][value=""]`);
    if (allRadio) allRadio.checked = true;
  }

  // âœ… 3) åˆæ¬¡æ¸²æŸ“ï¼ˆæ­¤æ™‚æœƒå¥—ç”¨ URL ç¯©é¸ï¼‰
  renderShop();

  // âœ… 4) ç›£è½ radio åˆ‡æ›
  document.querySelectorAll('input[name="age"]').forEach(radio => {
    radio.addEventListener('change', function () {
      currentAgeFilter = this.value || null;
      renderShop();
    });
  });
});
</script>

        
    <script src="../js/chat.js"></script>
</body>
</html>